"use strict";const e=require("../../../common/vendor.js");if(!Array){const f=e.resolveComponent("u-search"),u=e.resolveComponent("u-tabs"),p=e.resolveComponent("u-button"),l=e.resolveComponent("u-empty"),s=e.resolveComponent("u-loading-icon"),a=e.resolveComponent("u-icon");(f+u+p+l+s+a)()}const T=()=>"../../../uni_modules/uview-plus/components/u-search/u-search.js",D=()=>"../../../uni_modules/uview-plus/components/u-tabs/u-tabs.js",F=()=>"../../../uni_modules/uview-plus/components/u-button/u-button.js",N=()=>"../../../uni_modules/uview-plus/components/u-empty/u-empty.js",j=()=>"../../../uni_modules/uview-plus/components/u-loading-icon/u-loading-icon.js",k=()=>"../../../uni_modules/uview-plus/components/u-icon/u-icon.js";Math||(T+D+F+N+j+z+k)();const z=()=>"../../../components/order_card.js",B={__name:"index",setup(f){e.ref(e.index.getSystemInfoSync().statusBarHeight||0);const u=e.ref(""),p=e.ref(0),l=e.ref(!1),s=e.ref(!1),a=e.ref(!1),i=e.ref(!1),v=e.ref(1);e.ref(10);const n=e.ref([]),h=e.ref([{name:"待办",value:"pending"},{name:"全部",value:"all"},{name:"已完成",value:"completed"},{name:"未完成",value:"uncompleted"},{name:"其他",value:"other"}]),_=[{id:1,name:"A9二排5号机",deviceNo:"A9-2-5",status:"online",statusText:"在线",statusColor:"#2979ff",site:"湖南京广线-长沙南站-A区9号检票口",serialNo:"SF7336190300055",responsible:"赵佳志",date:"2024-01-15 09:30",priority:"high"},{id:2,name:"A9二排5号机",deviceNo:"A9-2-5",status:"offline",statusText:"离线",statusColor:"#909399",site:"湖南京广线-长沙南站-A区9号检票口",serialNo:"SF7336190300055",responsible:"赵佳志",date:"2024-01-15 10:15",priority:"medium"},{id:3,name:"A9二排5号机",deviceNo:"A9-2-5",status:"fault",statusText:"故障",statusColor:"#fa3534",site:"湖南京广线-长沙南站-A区9号检票口",serialNo:"SF7336190300055",responsible:"赵佳志",date:"2024-01-15 11:20",priority:"high"},{id:4,name:"A9二排5号机",deviceNo:"A9-2-5",status:"online",statusText:"在线",statusColor:"#2979ff",site:"湖南京广线-长沙南站-A区9号检票口",serialNo:"SF7336190300055",responsible:"赵佳志",date:"2024-01-15 13:45",priority:"low"}],g=o=>{p.value=o.index,c()},y=o=>{console.log("搜索关键词:",o),c()},x=()=>{u.value="",c()},b=o=>{console.log("点击订单:",o),e.index.navigateTo({url:`/pages/order/detail/index?id=${o.id}`})},C=()=>{e.index.scanCode({success:o=>{console.log("扫码结果:",o.result),e.index.showToast({title:"扫码成功",icon:"success"})},fail:o=>{console.error("扫码失败:",o),e.index.showToast({title:"扫码失败，请重试",icon:"none"})}})},d=async(o=!1,r=!1)=>{if(!(s.value||r&&i.value)){o?(l.value=!0,v.value=1):r?(a.value=!0,v.value++):s.value=!0;try{if(await new Promise(t=>setTimeout(t,1e3)),o||!r)n.value=[..._];else{const t=_.map(m=>({...m,id:m.id+n.value.length}));n.value=[...n.value,...t]}r&&v.value>=3&&(i.value=!0)}catch(t){console.error("获取订单列表失败:",t),e.index.showToast({title:"加载失败",icon:"none"})}finally{s.value=!1,a.value=!1,l.value=!1}}},c=()=>{d(!0)},w=()=>{i.value||d(!1,!0)},A=()=>{c()};return e.onLoad(()=>{d()}),e.onShow(()=>{c()}),(o,r)=>e.e({a:e.o(y),b:e.o(x),c:e.o(t=>u.value=t),d:e.p({placeholder:"关键词搜索, 如订单编号, 负责人",showAction:!1,shape:"square",bgColor:"#f5f5f5",modelValue:u.value}),e:e.o(g),f:e.p({list:h.value,current:p.value,activeStyle:{color:"#2979ff",fontWeight:"bold"},inactiveStyle:{color:"#666"},lineColor:"#2979ff",lineWidth:30,lineHeight:3,itemStyle:"padding-left: 15px; padding-right: 15px; height: 44px;"}),g:n.value.length===0&&!s.value},n.value.length===0&&!s.value?{h:e.o(d),i:e.p({type:"primary",text:"刷新",size:"mini"}),j:e.p({mode:"list",icon:"http://cdn.uviewui.com/uview/empty/list.png",text:"暂无巡检订单"})}:{},{k:s.value&&n.value.length===0},s.value&&n.value.length===0?{l:e.p({text:"加载中...",textSize:"16",color:"#2979ff"})}:{m:e.f(n.value,(t,m,S)=>({a:t.id||m,b:e.o(E=>b(t),t.id||m),c:"4eb6758f-5-"+S,d:e.p({task:t})}))},{n:a.value},a.value?{o:e.p({text:"加载中...",size:"20",textSize:"14",color:"#999"})}:{},{p:i.value},i.value?{}:{},{q:l.value,r:e.o(A),s:e.o(w),t:e.p({name:"scan",size:"20",color:"#fff"}),v:e.o(C),w:e.p({type:"primary",shape:"circle",customStyle:{height:"88rpx",fontSize:"32rpx",fontWeight:"500"}})})}};wx.createPage(B);
